library(ggplot2)
library(car)
library(car)
library(effects)
library(gridExtra)
library(ggpubr)
library(ellipse)
?install.packages
install.packages('ellipse')
library(ellipse)
library(dplyr)
library(vtable)
install.packages('vtable')
library(vtable)
library(reshape)
install.packages('reshape')
library(reshape)
library(corrplot)
library(knitr)
library(kableExtra)
library(GLMsData)
# Äe so podatki zunanji
data = data(lungcap)
data
data = lungcap
dim(data) # dimenzije vrstice, stolpci
head(data) # zaÄetek tabele
str(data)
summary(data) # min, max, kvantili, povpreÄje po spr
levels(data$Gender) # levli faktorske spr
levels(lungcap$Gender)
# Spremeni napovedno_spr v faktor
data$gender = factor(data$Gender, labels = c("Å½enske", "MoÅ¡ki"))
data$Smoke = factor(data$Smoke, labels=c("Ne", "Da"))
# Spremeni enote (recimo inch â†’ cm)
data$Ht = data$Ht*2.54
head(data) # zaÄetek tabele
rownames(data)
# Osnovni razsevni grafikon - 1. moÅ¾nost
ggplot(data = data) +
geom_point(mapping = aes(x = Ht, y = FEV)) +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)")
# Osnovni razsevni grafikon - 2. moÅ¾nost
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point() +
xlim(c(_,_)) +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") + theme_bw() # nariÅ¡i veÄ takih grafov za vsako Å¡tevilsko_napovedno_spr, odzivna_spr je ista, za opisne_napovedne_spr naredi boxplote â†’ zdruÅ¾i z ggarrange
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point()
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point() +
xlim(c(_,_))
# Osnovni razsevni grafikon - 2. moÅ¾nost
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point() +
xlim(c("_","_")) +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") + theme_bw() # nariÅ¡i veÄ takih grafov za vsako Å¡tevilsko_napovedno_spr, odzivna_spr je ista, za opisne_napovedne_spr naredi boxplote â†’ zdruÅ¾i z ggarrange
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point()
# Osnovni razsevni grafikon - 2. moÅ¾nost
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point() +
xlim(c(100,190)) +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") + theme_bw() # nariÅ¡i veÄ takih grafov za vsako Å¡tevilsko_napovedno_spr, odzivna_spr je ista, za opisne_napovedne_spr naredi boxplote â†’ zdruÅ¾i z ggarrange
# Osnovni razsevni grafikon - 2. moÅ¾nost
ggplot(data, aes(x = Ht, y = FEV)) +
geom_point() +
xlim(c(110,190)) +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") + theme_bw() # nariÅ¡i veÄ takih grafov za vsako Å¡tevilsko_napovedno_spr, odzivna_spr je ista, za opisne_napovedne_spr naredi boxplote â†’ zdruÅ¾i z ggarrange
hist(data$Ht, main="", xlab="", ylab="", breaks=20)
hist(data$Age, main="", xlab="", ylab="")
hist(data$Ht, main="Porazdelitev spremenljivke visina", xlab="Ht", ylab="freq", breaks=20)
hist(data$Age, main="Porazdelitev spremenljivke visina", xlab="Age", ylab="freq")
boxplot(placa$wage ~ placa$education,
xlab = "Age", ylab = "FEV")
boxplot(data$FEV ~ data$Age,
xlab = "Age", ylab = "FEV")
View(data)
# Spremeni napovedno_spr v faktor
data$Gender = factor(data$Gender, labels = c("Å½enske", "MoÅ¡ki"))
View(data)
data = head(data[,1:5])
data = lungcap # da se df imenuje data za naprej...
# Spremeni napovedno_spr v faktor
data$Gender = factor(data$Gender, labels = c("Å½enske", "MoÅ¡ki"))
data$Smoke = factor(data$Smoke, labels=c("Ne", "Da"))
# Spremeni enote (recimo inch â†’ cm)
data$Ht = data$Ht*2.54
View(data)
boxplot(data$FEV ~ data$Smoke,
xlab = "Smoke", ylab = "FEV")
# Osnovni boxplot
ggplot(data, aes(x=Gender, y=FEV)) +
geom_boxplot() +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") + theme_bw()
# Preglej vse kombinacije opisnih_napovednih_spr - boxploti
ggplot(data, aes(x=opisna_napovedna_spr1, y=FEV)) +
geom_boxplot() +
facet_wrap(.~ opisna_napovedna_spr2) +
xlab("opisna_napovedna_spr1") + ylab("odzivna_spr (enota)") + theme_bw()
# Osnovni boxplot
ggplot(data, aes(x=Gender, y=FEV)) +
geom_boxplot() +
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") + theme_bw()
ggplot(data, aes(x=Gender, y=FEV)) +
geom_boxplot() +
facet_wrap(.~ Smoke) +
xlab("opisna_napovedna_spr1") + ylab("odzivna_spr (enota)") + theme_bw()
# Vse kombinacije opisnih_napovednih_spr z gladilniki - za preverjanje linearnosti â†’ ta isti graf izriÅ¡i za vsako od Å¡tevilskih_napovednih_spr!! (samo to zamenjaj "x= " in ime x-osi) â†’ iste grafe ponovi tudi, Äe odzivno_spr transformiraÅ¡ (recimo daj log(odzivna_spr))
ggplot(data, aes(x=Ht, y=FEV)) +
geom_point() +
geom_smooth(se=FALSE) +
facet_grid(Gender ~ Smoke) +
xlab("Å¡tevilska_napovedna_spr") + ylab("odzivna_spr (enota)") + theme_bw()
# Vse kombinacije opisnih_napovednih_spr z gladilniki - za preverjanje linearnosti â†’ ta isti graf izriÅ¡i za vsako od Å¡tevilskih_napovednih_spr!! (samo to zamenjaj "x= " in ime x-osi) â†’ iste grafe ponovi tudi, Äe odzivno_spr transformiraÅ¡ (recimo daj log(odzivna_spr))
ggplot(data, aes(x=Ht, y=FEV)) +
geom_point() +
geom_smooth(se=TRUE) +
facet_grid(Gender ~ Smoke) +
xlab("Å¡tevilska_napovedna_spr") + ylab("odzivna_spr (enota)") + theme_bw()
# Osnovni razsevni grafikon, Äe imaÅ¡ 2 napovedni spr: eno opisno in eno Å¡tevilsko
ggplot(data = data, aes(x = Ht, y = FEV, col = Gender)) +
geom_point() +
xlab("Å¡tevilska_napovedna_spr (enota)") + ylab("odzivna_spr (mm)")
# Boxplot â†’ uporabi za opisne napovedne spr
boxplot(FEV ~ Gender, data = data, ylab = c("odzivna_spr (enota)"), xlab = "opsina_napovedna_spr")
# V kakÅ¡ni zvezi so pari analiziranih spremenljivk
pairs(data) # Robna odvisnost odzivne spr od napovednih spr, vsaka slika zase ne upoÅ¡teva prisotnosti drugih napovednih spr.
# V ukazu scatterplot iz paketa car se z argumentom id na sliki izpiÅ¡eta imeni izstopajoÄih podatkov in boxplota
# S tem prikazom lahko probaÅ¡ tudi npr. transformirati odzivno spr in prikazati Å¡e enkrat isto!
scatterplot(FEV ~ Age, regLine = FALSE, smooth = FALSE, boxplots = 'xy',
xlab = c("napovedna_spr (enota)"), ylab = c("odzivna_spr (enota)"),
data = data, pch = 16,
id = list(n = 2, location = "lr")) # id = TRUE
lm(FEV ~ Gender * Age, data = data)
lm(FEV ~ Gender + Age, data = data)
summary(lm(formula = FEV ~ Gender * Age, data = data))
model_gender = lm(FEV ~ Gender, data = data)
# Regresijski osamelci: studentizirani ostanki glede na kvantile ğ‘¡(SP=ğ‘›âˆ’ğ‘˜âˆ’2) in pripadajoÄa 95 % toÄkovna ovojnica (QQ grafikon)
qqPlot(model_gender, id = TRUE)
# Za vsako toÄko posebej preverjamo, ali je regresÄ³ski osamelec. NiÄelna domneva pravi, da ğ‘–-ta toÄka ni regresÄ³ski osamelec. IzpiÅ¡e vse tiste toÄke, pri katerih je nepopravljena ğ‘-vrednost pod 0.05.
outlierTest(model_gender) # toÄka je reg osamelec, Äe je Bonferroni p-vrednost manjÅ¡a od 0.05
model_age = lm(FEV ~ Age, data = data)
model_op_int = lm(FEV ~ Gender * Age, data = data)
qqPlot(model_age, id = TRUE)
qqPlot(model_op_int, id = TRUE)
outlierTest(model_age) # toÄka je reg osamelec, Äe je Bonferroni p-vrednost manjÅ¡a od 0.05
outlierTest(model_op_int, id = TRUE) # toÄka je reg osamelec, Äe je Bonferroni p-vrednost manjÅ¡a od 0.05
# Da preveriÅ¡ kako se modelske napovedi razlikujejo od dejanskih toÄk - regresijski osamelci
data[c(539, 576), ]
fitted(model_gender)[c(cifra1, cifra2)]
fitted(model_gender)[c(539, 576)]
fitted(model_op_int)[c(539, 576)]
log(data$model_op_int[c(539, 576)]) # brez log, Äe ga ne uporabljaÅ¡!
data$model_op_int[c(539, 576)] # brez log, Äe ga ne uporabljaÅ¡!
data$FEV[c(539, 576)] # brez log, Äe ga ne uporabljaÅ¡!
# Vzvodne toÄke:  Vzvod v odvisnosti od napovedne_spr za model
plot(data$Age, hatvalues(model), pch = 16,
xlab = c("napovedna_spr (enota)"), ylab = c("Vzvod"))
# Vzvodne toÄke:  Vzvod v odvisnosti od napovedne_spr za model
plot(data$Age, hatvalues(model_op_int), pch = 16,
xlab = c("napovedna_spr (enota)"), ylab = c("Vzvod"))
# GrafiÄni prikaz studentiziranih ostankov, vzvodov in Cookove razdalje (ploÅ¡Äina kroga je sorazmerna Cookovi razdalji) za model
influencePlot(model_op_int,
id = list(method = "noteworthy", n = 2, cex = 1, location = "lr"),
xlab = "Vzvodi", ylab = "Studentizirani ostanki") # n = Å¡tevilo toÄk z najveÄjo vrednostjo studentiziranega ostanka, ğ‘ toÄk z najveÄjim vzvodom in ğ‘ toÄk z najveÄjo Cookovo razdaljo (pogosto se toÄke prekrivajo in jih je v izpisu manj kot 3ğ‘)
# Vplivne toÄke:
vplivne = lm.influence(model_op_int)
names(vplivne)
sort(vplivne$hat, decreasing = TRUE)[1:4] # 4 toÄke z najveÄjimi vzvodi
vplivne$coeff["specifiÄna_toÄka",] # spremembi ocen b_0 in b_1, Äe specifiÄno toÄko izloÄimo
View(vplivne)
vplivne$coeff["628",] # spremembi ocen b_0 in b_1, Äe specifiÄno toÄko izloÄimo
sort(vplivne$coeff[,1],decreasing=TRUE)[1:4] # 4 toÄke z najveÄjo spremembo b_0
sort(vplivne$coeff[,2])[1:4] # 4 toÄke z najveÄjo spremembo naklona
sort(vplivne$sigma)[1:4] # izpis standardnih napak regresije brez vkljuÄenega podatka/toÄke
subset(data, subset = data$Age != "628")
vplivne$coeff["628",]
names(vplivne)
names(table(vplivne))
table(vplivne)
# Ena napovedna spr
m0 = lm(FEV ~ Gender, data = data)
# Dve napovedni spr
m1 = lm(odzivna_spr ~ Gender + Age, data = data)
# Dve napovedni spr
m1 = lm(FEV ~ Gender + Age, data = data)
# Komponente modela:
names(m0)
# Koeficienti modela
m0$coef
model = lm(FEV ~ Gender * Age, data = data)
modelska_matrika = model.matrix(model.m2)
head(modelska_matrika, n = 3)
modelska_matrika = model.matrix(model)
head(modelska_matrika, n = 3)
# ... nadaljuj z
anova(model)
# Izbira transformacije
symbox(~ FEV, xlab = "Lambda",
ylab = "Transformirane vrednosti za odzivno_spr",
data = data) # IzbereÅ¡ tisto, kjer je boxplot najbolj simetriÄen, najbolj podoben ~ N
# Oceni, katera lambda bi bila glede na maximum likelihood primerna
summary(powerTransform(model)) # razlaga spodaj
# Logaritem verjetja v odvisnosti od ğœ† za model, optimalna vrednost za ğœ† in njen 95 % IZ
par(mar = c(4, 4, 1, 1))
boxCox(model) # Pazi pri teh transformacijah, vÄasih ni razloÅ¾ljivo!
# Interpretacija eksponentne zveze:
model_exp = lm(log(FEV) ~ Ht, data = data)
(b = coefficients(model_exp))
exp(b[1]) # Eksponiraj intercept (beta0) â†’ Interpretacija je zdaj lahko: Ob napovedni_spr = 0, je odzivna_spr enaka exp(b[1]).
exp(confint(model_exp)[1,]) # Eksponiraj IZ za intercept
exp(b[2])-1 # Eksponiraj beta1 â†’ interpretacija je zdaj lahko: ÄŒe se napovedna_spr spremeni za 1, se odzivna_spr spremeni za exp(b[2])-1 * 100 %.
exp(confint(model_exp)[2,])-1 # Eksponiraj IZ za beta1
summary(model_exp)$r.squared
## 1.1 naÄin
plot(effect(c("Ht"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # Odvisnost odzivne_spr od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved odzivne_spr, skala za odzivno_spr je logaritemska!!!!
## 1.1 naÄin
plot(effect(c("Ht", "Age"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # Odvisnost odzivne_spr od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved odzivne_spr, skala za odzivno_spr je logaritemska!!!!
# Interpretacija eksponentne zveze:
model_exp = lm(log(FEV) ~ Ht*Age*Gender*Smoke, data = data)
(b = coefficients(model_exp))
exp(b[1]) # Eksponiraj intercept (beta0) â†’ Interpretacija je zdaj lahko: Ob napovedni_spr = 0, je odzivna_spr enaka exp(b[1]).
exp(confint(model_exp)[1,]) # Eksponiraj IZ za intercept
exp(b[2])-1 # Eksponiraj beta1 â†’ interpretacija je zdaj lahko: ÄŒe se napovedna_spr spremeni za 1, se odzivna_spr spremeni za exp(b[2])-1 * 100 %.
exp(confint(model_exp)[2,])-1 # Eksponiraj IZ za beta1
summary(model_exp)$r.squared
## 1.1 naÄin
plot(effect(c("Ht", "Age"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # Odvisnost odzivne_spr od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved odzivne_spr, skala za odzivno_spr je logaritemska!!!!
## 1.1 naÄin
plot(effect(c("Ht", "Age", "Smoke"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # Odvisnost odzivne_spr od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved odzivne_spr, skala za odzivno_spr je logaritemska!!!!
## 1.1 naÄin
plot(effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # Odvisnost odzivne_spr od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved odzivne_spr, skala za odzivno_spr je logaritemska!!!!
## 1.2 naÄin
plot(Effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log,inverse = exp)),
axes = list(y = list(lab = "odzivna_spr (enota)", type = "response")),
multiline=TRUE, ci.style="bands", main="", ylim=c(_, _))
## 1.2 naÄin
plot(Effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log,inverse = exp)),
axes = list(y = list(lab = "odzivna_spr (enota)", type = "response")),
multiline=TRUE, ci.style="bands", main="")
# Interpretacija eksponentne zveze:
model_exp = lm(log(FEV) ~ Age*Ht*Gender*Smoke, data = data)
## 1.1 naÄin
plot(effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # Odvisnost odzivne_spr od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved odzivne_spr, skala za odzivno_spr je logaritemska!!!!
mod2.int <- lm(log(FEV) ~ Age*Ht*Gender*Smoke, data=lungcap)
plot(Effect(c("Age","Ht","Gender","Smoke"), mod2.int, partial.residuals=TRUE), main="")
View(lungcap)
lungcap$Ht <- lungcap$Ht*2.54
lungcap$Smoke <- factor(lungcap$Smoke, labels=c("Ne", "Da"))
levels(lungcap$Gender)
levels(lungcap$Gender) <- c("Å½enske", "MoÅ¡ki")
mod2.int <- lm(log(FEV) ~ Age*Ht*Gender*Smoke, data=lungcap)
plot(Effect(c("Age","Ht","Gender","Smoke"), mod2.int, partial.residuals=TRUE), main="")
plot(Effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log,inverse = exp)),
axes = list(y = list(lab = "odzivna_spr (enota)", type = "response")),
multiline=TRUE, ci.style="bands", main="")
## 1.1 naÄin
plot(effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log, inverse = exp)),
axes = list(y = list(lab = "odzivna_spr")), main = "") # O
plot(Effect(c("Age","Ht","Gender","Smoke"), model_exp, partial.residuals=TRUE), main="")
plot(Effect(c("Age","Ht","Gender","Smoke"), model_exp, partial.residuals=TRUE, transformation = list(link = log,inverse = exp)), main="")
## 1.2 naÄin
plot(Effect(c("Ht", "Age", "Smoke", "Gender"), model_exp,
transformation = list(link = log,inverse = exp)),
axes = list(y = list(lab = "odzivna_spr (enota)", type = "response")),
multiline=TRUE, ci.style="bands", main="")
## 1.2 naÄin
plot(Effect(c("Age", "Ht", "Smoke", "Gender"), model_exp,
transformation = list(link = log,inverse = exp)),
axes = list(y = list(lab = "odzivna_spr (enota)", type = "response")),
multiline=TRUE, ci.style="bands", main="")
plot(Effect(c("Age","Ht","Gender","Smoke"), model_exp, partial.residuals=TRUE, transformation = list(link = log,inverse = exp)), main="")
plot(Effect(c("Age","Ht","Gender","Smoke"), model_exp, partial.residuals=TRUE, transformation = list(link = log,inverse = exp)),
axes = list(y = list(lab = "odzivna_spr (enota)", type = "response")), main="")
plot(Effect(c("Age","Ht","Gender","Smoke"), model_exp, partial.residuals=TRUE, transformation = list(link = log,inverse = exp)), main="", multiline = TRUE)
## 2. naÄin
ggplot(data = data, aes(x = Ht, y = log(FEV))) +
geom_point() + stat_smooth(method = "lm") +
xlab("napovedna_spr (enote!!!)") + ylab("log(odzivna_spr)") # Odvisnost log(odzivna_spr) od napovedna_spr in pripadajoÄa regresijska premica s 95 % IZ za povpreÄno napoved log(odzivna_spr)
# GrafiÄni prikazi (de-transformacija) za exp zvezo
ggplot(data = data, aes(x = Ht, y = FEV)) +
geom_point() + xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)") +
stat_function(fun = function(Ht) exp(b[1] + b[2] * Ht)) #  Odvisnost odzivna_spr od napovedna_spr; eksponentni model
head(model.matrix(model)) # da preveriÅ¡ referenÄne skupine
tail(model.matrix(model))
# Dodatek regresijske premice na razsevni grafikon
ggplot(data = data, mapping = aes(x = napovedna_spr, y = odzivna_spr)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) + # Äe daÅ¡ se=TRUE dobiÅ¡ 95% IZ za povpreÄno napoved!!
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)")
# Dodatek regresijske premice na razsevni grafikon
ggplot(data = data, mapping = aes(x = Ht*Gender, y = odzivna_spr)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) + # Äe daÅ¡ se=TRUE dobiÅ¡ 95% IZ za povpreÄno napoved!!
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)")
# Dodatek regresijske premice na razsevni grafikon
ggplot(data = data, mapping = aes(x = c(Ht, Gender), y = odzivna_spr)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) + # Äe daÅ¡ se=TRUE dobiÅ¡ 95% IZ za povpreÄno napoved!!
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)")
# Dodatek regresijske premice na razsevni grafikon
ggplot(data = data, mapping = aes(x = c(Ht, Gender), y = FEV)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) + # Äe daÅ¡ se=TRUE dobiÅ¡ 95% IZ za povpreÄno napoved!!
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)")
# Dodatek regresijske premice na razsevni grafikon
ggplot(data = data, mapping = aes(x = Ht, y = FEV)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) + # Äe daÅ¡ se=TRUE dobiÅ¡ 95% IZ za povpreÄno napoved!!
xlab("napovedna_spr (enote)") + ylab("odzivna_spr (enote)")
summary(m1)
# Graf dodane spremenljivke
avPlots(m1, ylim = c(0, 200)) # Vpliv vsake od napovednih spr na odzivno spr ob upoÅ¡tevanju ostalih spr v modelu (= pri konstantni vrednosti ostalih spr) - naklon je enak oceni parametrov za tisto spremenljivko
# Graf dodane spremenljivke
avPlots(m1, ylim = c(0, 3)) # Vpliv vsake od napovednih spr na odzivno spr ob upoÅ¡tevanju ostalih spr v modelu (= pri konstantni vrednosti ostalih spr) - naklon je enak oceni parametrov za tisto spremenljivko
# Graf dodane spremenljivke
avPlots(m1, ylim = c(-1, 3)) # Vpliv vsake od napovednih spr na odzivno spr ob upoÅ¡tevanju ostalih spr v modelu (= pri konstantni vrednosti ostalih spr) - naklon je enak oceni parametrov za tisto spremenljivko
# Graf dodane spremenljivke
avPlots(m1, ylim = c(-3, 3)) # Vpliv vsake od napovednih spr na odzivno spr ob upoÅ¡tevanju ostalih spr v modelu (= pri konstantni vrednosti ostalih spr) - naklon je enak oceni parametrov za tisto spremenljivko
# Graf dodane spremenljivke
avPlots(m1, ylim = c(-3, 5)) # Vpliv vsake od napovednih spr na odzivno spr ob upoÅ¡tevanju ostalih spr v modelu (= pri konstantni vrednosti ostalih spr) - naklon je enak oceni parametrov za tisto spremenljivko
# Graf parcialnih ostankov
crPlots(m1, ylim = c(-5, 5))# Odvisnosti odzivne spr od posamezne napovedne spr upoÅ¡tevajoÄ drugo/-e spr v modelu â†’ BREZ INTERAKCIJ
# Graf parcialnih ostankov
crPlots(model_exp, ylim = c(-5, 5))# Odvisnosti odzivne spr od posamezne napovedne spr upoÅ¡tevajoÄ drugo/-e spr v modelu â†’ BREZ INTERAKCIJ
plot(Effect(c("Ht", "Age", "Gender", "Smoke"), model_exp), multiline=TRUE,
ci.style="bands", main="", ylim=c(-10,10)) #  Modelske napovedi za odzivno_spr v odvisnosti od spr1, spr2 in spr3 hkrati, pri povpreÄni vrendosti spr4 za model â†’ Z INTERAKCIJAMI (iste grafe nariÅ¡eÅ¡ pred in po vkljuÄitvijo interakcij!!) â†’ glej interakcije
plot(Effect(c("Ht", "Age", "Gender", "Smoke"), model_exp), multiline=TRUE,
ci.style="bands", main="", ylim=c(-5,5)) #  Modelske napovedi za odzivno_spr v odvisnosti od spr1, spr2 in spr3 hkrati, pri povpreÄni vrendosti spr4 za model â†’ Z INTERAKCIJAMI (iste grafe nariÅ¡eÅ¡ pred in po vkljuÄitvijo interakcij!!) â†’ glej interakcije
plot(Effect(c("Ht", "Age", "Gender", "Smoke"), model_exp), multiline=TRUE,
ci.style="bands", main="", ylim=c(-3,3)) #  Modelske napovedi za odzivno_spr v odvisnosti od spr1, spr2 in spr3 hkrati, pri povpreÄni vrendosti spr4 za model â†’ Z INTERAKCIJAMI (iste grafe nariÅ¡eÅ¡ pred in po vkljuÄitvijo interakcij!!) â†’ glej interakcije
plot(Effect(c("Age", "Ht", "Gender", "Smoke"), model_exp), multiline=TRUE,
ci.style="bands", main="", ylim=c(-3,3)) #  Modelske napovedi za odzivno_spr v odvisnosti od spr1, spr2 in spr3 hkrati, pri povpreÄni vrendosti spr4 za model â†’ Z INTERAKCIJAMI (iste grafe nariÅ¡eÅ¡ pred in po vkljuÄitvijo interakcij!!) â†’ glej interakcije
plot(Effect(c("Age", "Ht", "Gender", "Smoke"), model_exp), multiline=FALSE,
ci.style="bands", main="", ylim=c(-3,3)) #  Modelske napovedi za odzivno_spr v odvisnosti od spr1, spr2 in spr3 hkrati, pri povpreÄni vrendosti spr4 za model â†’ Z INTERAKCIJAMI (iste grafe nariÅ¡eÅ¡ pred in po vkljuÄitvijo interakcij!!) â†’ glej interakcije
plot(Effect(c("Age","Ht","Gender","Smoke"), mod2.int, partial.residuals=TRUE), main="")
plot(Effect(c("Age", "Ht", "Gender", "Smoke"), model_exp), partial.residuals = TRUE, multiline=FALSE,
ci.style="bands", main="", ylim=c(-3,3)) #  Modelske napovedi za odzivno_spr v odvisnosti od spr1, spr2 in spr3 hkrati, pri povpreÄni vrendosti spr4 za model â†’ Z INTERAKCIJAMI (iste grafe nariÅ¡eÅ¡ pred in po vkljuÄitvijo interakcij!!) â†’ glej interakcije
